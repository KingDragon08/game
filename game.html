<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/game.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, height=device-height">
    <title>车惠买翻牌游戏</title>
  </head>
  <body>
    <div class="title">车惠买品牌购车嘉年华</div>
    <div class="container" style="height:auto; overflow:auto;">
      <div class="box viewport-flip" id="box1" onclick="kd_rotate(1)">
        <div class="list flip out" style="background:#fff;">
          <img src="image/yihan.png" class="icon">
          <p class="icon_info">未能中奖</p>
        </div>
        <div class="list flip in" style="background:url('image/back.png') center center no-repeat; background-size:cover;"></div>
      </div>
      <div class="box viewport-flip" id="box2" onclick="kd_rotate(2)">
        <div class="list flip out" style="background:#fff;">
          <img src="image/yihan.png" class="icon">
          <p class="icon_info">未能中奖</p>
        </div>
        <div class="list flip in" style="background:url('image/back.png') center center no-repeat; background-size:cover;"></div>
      </div>
      <div class="box viewport-flip" id="box3" onclick="kd_rotate(3)">
        <div class="list flip out" style="background:#fff;">
          <img src="image/yihan.png" class="icon">
          <p class="icon_info">未能中奖</p>
        </div>
        <div class="list flip in" style="background:url('image/back.png') center center no-repeat; background-size:cover;"></div>
      </div>
      <div class="box viewport-flip" id="box4" onclick="kd_rotate(4)">
        <div class="list flip out" style="background:#fff;">
          <img src="image/yihan.png" class="icon">
          <p class="icon_info">未能中奖</p>
        </div>
        <div class="list flip in" style="background:url('image/back.png') center center no-repeat; background-size:cover;"></div>
      </div>
      <div class="box viewport-flip" id="box5" onclick="kd_rotate(5)">
        <div class="list flip out" style="background:#fff;">
          <img src="image/yihan.png" class="icon">
          <p class="icon_info">未能中奖</p>
        </div>
        <div class="list flip in" style="background:url('image/back.png') center center no-repeat; background-size:cover;"></div>
      </div>
      <div class="box viewport-flip" id="box6" onclick="kd_rotate(6)">
        <div class="list flip out" style="background:#fff;">
          <img src="image/yihan.png" class="icon">
          <p class="icon_info">未能中奖</p>
        </div>
        <div class="list flip in" style="background:url('image/back.png') center center no-repeat; background-size:cover;"></div>
      </div>
      <div class="box viewport-flip" id="box7" onclick="kd_rotate(7)">
        <div class="list flip out" style="background:#fff;">
          <img src="image/yihan.png" class="icon">
          <p class="icon_info">未能中奖</p>
        </div>
        <div class="list flip in" style="background:url('image/back.png') center center no-repeat; background-size:cover;"></div>
      </div>
      <div class="box viewport-flip" id="box8" onclick="kd_rotate(8)">
        <div class="list flip out" style="background:#fff;">
          <img src="image/yihan.png" class="icon">
          <p class="icon_info">未能中奖</p>
        </div>
        <div class="list flip in" style="background:url('image/back.png') center center no-repeat; background-size:cover;"></div>
      </div>
      <div class="box viewport-flip" id="box9" onclick="kd_rotate(9)">
        <div class="list flip out" style="background:#fff;">
          <img src="image/yihan.png" class="icon">
          <p class="icon_info">未能中奖</p>
        </div>
        <div class="list flip in" style="background:url('image/back.png') center center no-repeat; background-size:cover;"></div>
      </div>
    </div>
    <div style="text-align:center;">汽车之家版权所有</div>

    <div class="ctr_bg">
      <div class="ctr_panel">
        <div class="ctr_title">设置中奖牌</div>
        <table style="margin-top:20px;" width="43%" align="center">
          <tr>
            <td align="center" height="50" valign="middle">
              <input type="text" class="ctr_input" placeholder="中奖编码">
            </td>
            <td align="center" valign="middle">
              <input type="text" class="ctr_input" placeholder="中奖编码">
            </td>
            <td align="center" valign="middle">
              <input type="text" class="ctr_input" placeholder="中奖编码">
            </td>
          </tr>
          <tr>
            <td align="center" height="50" valign="middle">
              <input type="text" class="ctr_input" placeholder="中奖编码">
            </td>
            <td align="center" valign="middle">
              <input type="text" class="ctr_input" placeholder="中奖编码">
            </td>
            <td align="center" valign="middle">
              <input type="text" class="ctr_input" placeholder="中奖编码">
            </td>
          </tr>
          <tr>
            <td align="center" height="50" valign="middle">
              <input type="text" class="ctr_input" placeholder="中奖编码">
            </td>
            <td align="center" valign="middle">
              <input type="text" class="ctr_input" placeholder="中奖编码">
            </td>
            <td align="center" valign="middle">
              <input type="text" class="ctr_input" placeholder="中奖编码">
            </td>
          </tr>
        </table>
        <div class="ctr_name">
          <input type="text" placeholder="一等奖名称(1-5个字)" id="jiang_1">
          <input type="text" placeholder="二等奖名称(1-5个字)" id="jiang_2">
          <input type="text" placeholder="三等奖名称(1-5个字)" id="jiang_3">
        </div>
        <div class="ctr_confirm" onclick="go()">确认配置</div>
        <div class="ctr_tips">
          不中奖填0 <br>
          一等奖填1 <br>
          二等奖填2 <br>
          三等奖填3 <br>
          每次抽完奖刷新页面
        </div>
      </div>
    </div>

  </body>
  <script src="js/jquery.min.js"></script>
  <script>
  // 在前面显示的元素，隐藏在后面的元素
  eleBack = new Array(9);
  eleFront = new Array(9);
  data = "";

  function funBackOrFront(index)
  {
    var eleList = $("#box"+index+" .list");
  	eleList.each(function() {
  		if ($(this).hasClass("out")) {
  			eleBack[index-1] = $(this);
  		} else {
  			eleFront[index-1] = $(this);
  		}
  	});
  };

  //初始化前后元素
  var i=1;
  while(i<10)
  {
    funBackOrFront(i);
    i++;
  }

  //点击事件响应函数
  function kd_rotate(index)
  {
    eleFront[index-1].addClass("out").removeClass("in");
  	setTimeout(function() {
  		eleBack[index-1].addClass("in").removeClass("out");
  		funBackOrFront(index);
  	}, 225);
  	return false;
  }

  var key_count = 0;
  //监听打开设置的按键
  $(document).ready(function(){
        document.onkeydown = function()
        {
            var oEvent = window.event;
            if (oEvent.shiftKey && oEvent.ctrlKey) {
                if(key_count==0)//打开设置面板
                {
                  $(".ctr_bg").fadeIn();
                  key_count=1;
                }
                else
                {
                  $(".ctr_bg").fadeOut()
                  key_count=0;
                }
            }
        }
    }
  );

  //设置奖项完毕
  function go()
  {
    //检查设置是否完成
    var setting_ok = 0;
    data  = new Array();
    $("input.ctr_input").each(function(){
      if($(this).val().length==1)
      {
        if($(this).val()==0||$(this).val()==1||$(this).val()==2||$(this).val()==3)
        {
          data.push($(this).val());
          setting_ok++;
        }
      }
    });
    if(setting_ok==9)//设置正确
    {
      //检查奖品名是否填写
      var jiang_1 = $("#jiang_1").val();
      var jiang_2 = $("#jiang_2").val();
      var jiang_3 = $("#jiang_3").val();
      if((jiang_1.length>0&&jiang_1.length<=5)
            && (jiang_2.length>0&&jiang_2.length<=5)
            && (jiang_3.length>0&&jiang_3.length<=5))
      {
        //遍历data设置牌面
        $(data).each(function(index,val){
          if(val==0)//不中奖
          {
            $("#box"+(index+1)+" .icon").attr("src","image/yihan.png");
            $("#box"+(index+1)+" .icon_info").html("未能中奖");
          }
          if(val==1)//一等奖
          {
            $("#box"+(index+1)+" .icon").attr("src","image/jiang.png");
            $("#box"+(index+1)+" .icon_info").html("一等奖:"+jiang_1);
          }
          if(val==2)//二等奖
          {
            $("#box"+(index+1)+" .icon").attr("src","image/jiang.png");
            $("#box"+(index+1)+" .icon_info").html("二等奖:"+jiang_2);
          }
          if(val==3)//三等奖
          {
            $("#box"+(index+1)+" .icon").attr("src","image/jiang.png");
            $("#box"+(index+1)+" .icon_info").html("三等奖:"+jiang_3);
          }
        });
        //隐藏设置面板
        $(".ctr_bg").fadeOut();
        key_count=0;
      }
      else
      {
        alert("奖品名称设置错误");
      }
    }
    else
    {
      alert("中奖牌设置错误");
    }
  }

  </script>
</html>
